<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teacher OS v14</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="layout">
    
    <aside class="sidebar">
        <div class="logo">
            <i class="fas fa-shapes"></i> <span>Titanium v14</span>
        </div>

        <div class="user-card" onclick="openConfigModal()">
            <div class="avatar">Pro</div>
            <div class="user-info">
                <h4 id="lblProfileName">Docente</h4>
                <small>ConfiguraciÃ³n âš™ï¸</small>
            </div>
        </div>

        <nav class="menu">
            <p class="menu-label">PRINCIPAL</p>
            <button onclick="nav('dashboard')" id="nav-dashboard" class="active">
                <i class="fas fa-home"></i> Dashboard
            </button>
            <button onclick="nav('notebook')" id="nav-notebook" class="special-btn">
                <i class="fas fa-book-journal-whills"></i> <b>Notebook (Admin)</b>
            </button>

            <p class="menu-label">MIS CLASES (VISTA)</p>
            <div id="sidebarClassList">
                </div>
            <button onclick="openModal('modalClass')" class="add-btn"><i class="fas fa-plus"></i> Nueva Clase</button>
        </nav>

        <div class="status-bar">
            <span id="cloudStatus">â˜ï¸ Offline</span>
        </div>
    </aside>

    <main class="content">

        <section id="view-dashboard" class="page active">
            <header class="page-header">
                <h1>Panel de Control</h1>
                <p>Resumen de tu semana y alertas</p>
            </header>

            <div class="dashboard-grid">
                <div class="card full-width">
                    <div class="card-head">
                        <h3>ğŸ“… Horario Semanal</h3>
                        <button onclick="openScheduleEditor()" class="btn-text">Editar Horario</button>
                    </div>
                    <div class="week-grid" id="dashSchedule"></div>
                </div>

                <div class="card">
                    <h3>ğŸ“Œ PrÃ³ximas Entregas/Eventos</h3>
                    <div id="dashPlannerList" class="simple-list"></div>
                </div>

                <div class="card">
                    <h3>ğŸ“¢ Ãšltimas Incidencias</h3>
                    <div id="dashLogList" class="simple-list"></div>
                </div>
            </div>
        </section>

        <section id="view-notebook" class="page">
            <header class="page-header">
                <h1>Notebook Global</h1>
                <p>Gestiona todo desde aquÃ­: Alumnos, Notas y PlanificaciÃ³n.</p>
            </header>

            <div class="tabs-container">
                <button class="tab active" onclick="switchNbTab('tab-nb-students')">ğŸ‘¥ Estudiantes</button>
                <button class="tab" onclick="switchNbTab('tab-nb-gradebook')">ğŸ“Š Gradebook (Notas)</button>
                <button class="tab" onclick="switchNbTab('tab-nb-planning')">ğŸ“… Planning</button>
                <button class="tab" onclick="switchNbTab('tab-nb-logs')">ğŸ“– BitÃ¡cora Maestra</button>
            </div>

            <div id="tab-nb-students" class="tab-content active">
                <div class="toolbar">
                    <select id="filterStudentClass" onchange="renderStudents()"></select>
                    <button onclick="openModal('modalStudent')" class="btn-primary">+ Agregar Alumno</button>
                </div>
                <div id="studentsTable" class="table-responsive"></div>
            </div>

            <div id="tab-nb-gradebook" class="tab-content">
                <div class="toolbar">
                    <select id="filterGradebookClass" onchange="renderGradebook()"></select>
                    <button onclick="openModal('modalAssignment')" class="btn-primary">+ Nueva Columna (Actividad)</button>
                </div>
                <div class="alert-box">ğŸ’¡ Edita las notas directamente en las celdas. Se guardan automÃ¡ticamente.</div>
                <div id="gradebookContainer" class="excel-container"></div>
            </div>

            <div id="tab-nb-planning" class="tab-content">
                <div class="toolbar">
                    <select id="filterPlanClass" onchange="renderPlanning()">
                        <option value="">Todas las clases</option>
                    </select>
                    <button onclick="openModal('modalPlanning')" class="btn-primary">+ Nuevo Evento</button>
                </div>
                <div id="planningGrid" class="cards-grid"></div>
            </div>

            <div id="tab-nb-logs" class="tab-content">
                <div class="toolbar">
                    <button onclick="openLogModal()" class="btn-primary">+ Nueva Entrada BitÃ¡cora</button>
                </div>
                <div id="globalLogsList" class="timeline"></div>
            </div>
        </section>

        <section id="view-class" class="page">
            <header class="page-header">
                <div>
                    <h1 id="viewClassTitle">Clase</h1>
                    <p>Vista de Clase</p>
                </div>
                <div>
                    <button onclick="toggleAttendance()" class="btn-secondary">ğŸ™‹â€â™‚ï¸ Tomar Asistencia</button>
                    <button onclick="deleteCurrentClass()" class="btn-danger-outline"><i class="fas fa-trash"></i></button>
                </div>
            </header>

            <div id="attendanceWidget" class="attendance-panel" style="display:none;">
                <h3>Asistencia: <span id="attDate">Hoy</span></h3>
                <div id="attList" class="att-grid"></div>
                <div class="att-footer">
                    <button onclick="saveAttendance()" class="btn-primary small">Guardar Asistencia</button>
                    <button onclick="toggleAttendance()" class="btn-text small">Cerrar</button>
                </div>
            </div>

            <div class="class-cols">
                <div class="col-left">
                    <div class="card">
                        <h3>ğŸ“Š Calificaciones (Lectura)</h3>
                        <div id="classGradebookView" class="readonly-table"></div>
                    </div>
                    <div class="card">
                        <h3>ğŸ“… PrÃ³ximos Eventos de esta Clase</h3>
                        <div id="classPlanningView" class="simple-list"></div>
                    </div>
                </div>

                <div class="col-right">
                    <div class="card">
                        <h3>ğŸ“– Historial de BitÃ¡cora</h3>
                        <div id="classLogbookView" class="timeline"></div>
                    </div>
                </div>
            </div>
        </section>

    </main>
</div>

<div id="modalConfig" class="modal-overlay">
    <div class="modal-box">
        <h3>ConfiguraciÃ³n</h3>
        <label>Nombre del Profesor</label>
        <input type="text" id="cfgName">
        <hr>
        <label>Nube Pantry (ID requerido en script)</label>
        <div class="btn-row">
            <button onclick="cloudSync('pull')" class="btn-secondary">ğŸ“¥ Bajar Datos</button>
            <button onclick="cloudSync('push')" class="btn-primary">ğŸ“¤ Subir Datos</button>
        </div>
        <div class="modal-footer">
            <button onclick="saveConfig()" class="btn-primary full">Guardar</button>
            <button onclick="closeModal('modalConfig')" class="btn-flat full">Cancelar</button>
        </div>
    </div>
</div>

<div id="modalClass" class="modal-overlay">
    <div class="modal-box">
        <h3>Nueva Clase</h3>
        <input type="text" id="newClassName" placeholder="Nombre (ej. MatemÃ¡ticas 5A)">
        <div class="modal-footer">
            <button onclick="addClass()" class="btn-primary">Crear</button>
            <button onclick="closeModal('modalClass')" class="btn-flat">Cancelar</button>
        </div>
    </div>
</div>

<div id="modalStudent" class="modal-overlay">
    <div class="modal-box">
        <h3>Agregar Alumno</h3>
        <input type="text" id="newStudName" placeholder="Nombre Completo">
        <label>Asignar a clase:</label>
        <select id="newStudClass"></select>
        <div class="modal-footer">
            <button onclick="addStudent()" class="btn-primary">Guardar</button>
            <button onclick="closeModal('modalStudent')" class="btn-flat">Cancelar</button>
        </div>
    </div>
</div>

<div id="modalAssignment" class="modal-overlay">
    <div class="modal-box">
        <h3>Nueva Actividad (Columna)</h3>
        <input type="text" id="newAssTitle" placeholder="TÃ­tulo (ej. Examen 1)">
        <input type="text" id="newAssTag" placeholder="Etiqueta corta (ej. P1)">
        <label>Para la clase:</label>
        <select id="newAssClass"></select>
        <div class="modal-footer">
            <button onclick="addAssignment()" class="btn-primary">Crear Columna</button>
            <button onclick="closeModal('modalAssignment')" class="btn-flat">Cancelar</button>
        </div>
    </div>
</div>

<div id="modalPlanning" class="modal-overlay">
    <div class="modal-box">
        <h3>Planificar Evento</h3>
        <input type="text" id="planTitle" placeholder="TÃ­tulo (ej. Entrega de Proyecto)">
        <div class="row-inputs">
            <input type="date" id="planDate">
            <input type="text" id="planTag" placeholder="Tipo (ej. Examen, Tarea...)">
        </div>
        <label>Clase:</label>
        <select id="planClass"></select>
        <textarea id="planDesc" placeholder="Detalles..."></textarea>
        <div class="modal-footer">
            <button onclick="addPlanning()" class="btn-primary">Guardar</button>
            <button onclick="closeModal('modalPlanning')" class="btn-flat">Cancelar</button>
        </div>
    </div>
</div>

<div id="modalLog" class="modal-overlay">
    <div class="modal-box">
        <h3>Entrada de BitÃ¡cora</h3>
        <input type="hidden" id="logId"> <label>Alumno:</label>
        <select id="logStudent"></select>
        <label>Importancia:</label>
        <select id="logImp">
            <option value="low">ğŸŸ¢ Info / Positivo</option>
            <option value="medium">ğŸŸ  ObservaciÃ³n</option>
            <option value="high">ğŸ”´ Alerta / Incidencia</option>
        </select>
        <textarea id="logText" rows="4" placeholder="Â¿QuÃ© sucediÃ³?"></textarea>
        <div class="modal-footer">
            <button onclick="saveLog()" class="btn-primary">Guardar Entrada</button>
            <button onclick="closeModal('modalLog')" class="btn-flat">Cancelar</button>
        </div>
    </div>
</div>

<div id="modalSchedule" class="modal-overlay">
    <div class="modal-box">
        <h3>Agregar Bloque Horario</h3>
        <label>DÃ­a:</label>
        <select id="schDay">
            <option value="Lunes">Lunes</option><option value="Martes">Martes</option>
            <option value="MiÃ©rcoles">MiÃ©rcoles</option><option value="Jueves">Jueves</option>
            <option value="Viernes">Viernes</option>
        </select>
        <label>Clase:</label>
        <select id="schClass"></select>
        <div class="row-inputs">
            <input type="time" id="schStart">
            <input type="time" id="schEnd">
        </div>
        <div class="modal-footer">
            <button onclick="addScheduleItem()" class="btn-primary">AÃ±adir</button>
            <button onclick="closeModal('modalSchedule')" class="btn-flat">Cerrar</button>
        </div>
    </div>
</div>

<script src="script.js"></script>
</body>
</html>